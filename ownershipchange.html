<!DOCTYPE html>
<html lang="ml">
<head>
  <meta charset="UTF-8">
  <title>തിരുവന്തപുരം നഗരസഭ അറിയിപ്പ്</title>
  <style>
     body {
      font-family: 'Noto Sans Malayalam', 'Arial Unicode MS', Arial, sans-serif;
      margin: 0;
      background-color: #f4f6f9;
      padding: 20px;
      line-height: 1.6;
    }

    .container {
      max-width: 800px;
      margin: auto;
      background: white;
      padding: 30px;
      border-radius: 0;
      
    }

    .header {
      text-align: center;
      margin-bottom: 10px;
    }
   
    .center {
      text-align: center;
    }
    .section {
      margin-top: 30px;
      text-indent: 2em;
      text-align: justify;
    }

     .section2 {
      display: flex;
      justify-content: space-between;
      border-bottom: 1px solid #000;
      padding-bottom: 3px;
      margin-bottom: 20px;
      border-top: 1px solid #000;
      padding-top: 3px;
      margin-top: 20px;
    }

     .section1 {
      margin-top: 30px;
       
    }
     .blank-space {
   display: inline-block;
      border-bottom: 1px dotted #000;
      min-width: 150px;
      margin: 0 5px;

  }
    
    .bold {
      text-align: justify;
   
    }
    .underline {
      text-decoration: underline;
    }
    .right {
      text-align: right;
      margin-top: 50px;
    }
   .info-table {
    display: table;
    width: auto;
    font-family: 'Noto Sans Malayalam', sans-serif; /* Optional for better Malayalam rendering */
  }

  .info-row {
    display: table-row;
  }

  .info-label, .info-colon, .info-value {
    display: table-cell;
    padding: 2px 5px;
    vertical-align: top;
  }

  .info-label {
    white-space: nowrap;
    font-weight: normal;
  }

  .info-colon {
    width: 10px;
    text-align: center;
  }

  .info-value {
    white-space: nowrap;
  }
 
  </style>
</head>
<body>
 <div class="container">
    <div style="text-align: center; margin-bottom: 20px;">
        <img src="https://upload.wikimedia.org/wikipedia/commons/thumb/7/70/Seal_of_Corporation_of_Thiruvananthapuram_by_dhevilal.svg/600px-Seal_of_Corporation_of_Thiruvananthapuram_by_dhevilal.svg.png?20180901020657" 
             style="width: 100px; height: auto;" 
             alt="Seal of Thiruvananthapuram Corporation">
        <h3>തിരുവനന്തപുരം നഗരസഭ</h3>
      </div>


  <div class="section2">
    <p><span >നമ്പർ:</span> <span id="notice_number"></span></p>
    <p><span >തീയതി:</span> <span id="notice_date"></span></p>
  </div>

  <h3 class="center underline">അറിയിപ്പ്</h3>

<div class="section1">
  <p><span class="bold">വിഷയം:</span> തിരുവനന്തപുരം നഗരസഭ റവന്യു വസ്തുനികുതി വിഭാഗം - കെട്ടിടത്തിന്റെ ഉടമസ്ഥാവകാശം മാറ്റുന്നത് സംബന്ധിച്ച്.</p>
</div>

<div class="info-table">
  <div class="info-row">
    <div class="info-label">ഉടമയുടെ പേര് / വീട്ടുപേര്</div>
    <div class="info-colon">:</div>
    <div class="info-value" id="owner_new">(Owner Name/House Name)</div>
  </div>
  <div class="info-row">
    <div class="info-label">വാർഡിന്റെ പേര് / നമ്പർ</div>
    <div class="info-colon">:</div>
    <div class="info-value" id="ward1">(Ward Name / WardNumber)</div>
  </div>
  <div class="info-row">
    <div class="info-label">കെട്ടിട നമ്പർ (ടി. സി നമ്പർ)</div>
    <div class="info-colon">:</div>
    <div class="info-value" id="doorNo1">(Property Number)</div>
  </div>
  <div class="info-row">
    <div class="info-label">സർവ്വേ നമ്പർ</div>
    <div class="info-colon">:</div>
    <div class="info-value" id="surveyNo1"></div>
  </div>
</div>

<div class="section">
  <p>
    തിരുവനന്തപുരം നഗരസഭയിലെ <span id="ward2"  class="blank-space "></span> വാർഡിൽ <span id="doorNo2"  class="blank-space"></span> നമ്പർ കെട്ടിടത്തിൽ നിലവിൽ താങ്കൾ താമസിച്ചുവരുന്നതായി അന്വേഷണത്തിൽ ബോധ്യപ്പെടുന്നു.
    എന്നാൽ കോർപ്പറേഷൻ രേഖകളിൽ മേൽപ്പറഞ്ഞ കെട്ടിടം <span id="owner2"  class="blank-space "></span> എന്നയാളുടെ ഉടമസ്ഥാതയിലാണ് കാണുന്നത്.
    ആയതിനാൽ ഇ അറിയിപ്പ് കൈപ്പറ്റി 15 ദിവസത്തിനകം കേരള മുനിസിപ്പൽ ആക്ട് 240 -) o വകുപ്പ് പ്രകാരം
    കെട്ടിടത്തിന്റെ ഉടമസ്ഥാവകാശം മാറ്റുന്നതിന് ആവശ്യമായ രേഖകൾ സഹിതം കെ സ്മാർട്ട് (K SMART) മുഖേന അപേക്ഷ സമർപ്പിക്കേണ്ടതാണ്.
  </p>
</div>

<p class="right bold">സെക്രട്ടറി</p>

</div>
  <script>
    function evaluateArcadeExpression(feature, expression) {
      try {
        if (!expression || !feature) return "";
        if (expression.startsWith('$feature.')) {
          const fieldName = expression.replace('$feature.', '').trim();
          return feature[fieldName] || "";
        }
        if (expression.startsWith('IIF(')) {
          const regex = /IIF\(\$feature\.(\w+)\s*==\s*['"](.*?)['"],\s*\$feature\.(\w+),\s*\$feature\.(\w+)\)/;
          const match = expression.match(regex);
          if (match) {
            const [_, fieldName, compareValue, trueField, falseField] = match;
            return feature[fieldName] === compareValue ? feature[trueField] : feature[falseField];
          }
        }
        if (expression.includes('+')) {
          const parts = expression.split('+');
          return parts.map(part => {
            part = part.trim();
            if (part.startsWith('$feature.')) {
              const fieldName = part.replace('$feature.', '').trim();
              return feature[fieldName] || "";
            } else {
              return part.replace(/['"]/g, '');
            }
          }).join('');
        }
        return expression;
      } catch (error) {
        console.error("Error evaluating Arcade expression:", error);
        return "";
      }
    }

    function getFeatureFromParams() {
      const params = new URLSearchParams(window.location.search);
      return {
        WARD_NAME: params.get("ward"),
        DOOR_NO: params.get("id"),
        OWNER_NAME: params.get("owner"),
        SURVEY_NO: params.get("surveyNo"),
      };
    }

  function applyArcadeExpressions() {
      const feature = getFeatureFromParams();
      const noticeNo = generateNoticeNumber();
      const noticeDate = new Date().toLocaleDateString('en-IN');

      const owner = evaluateArcadeExpression(feature, "$feature.OWNER_NAME");
      const ward = evaluateArcadeExpression(feature, "$feature.WARD_NAME");
      const doorNo = "T" + evaluateArcadeExpression(feature, "$feature.DOOR_NO");
      const surveyNo = evaluateArcadeExpression(feature, "$feature.SURVEY_NO");

      document.getElementById("noticeNo").textContent = noticeNo;
      document.getElementById("noticeDate").textContent = noticeDate;

      document.getElementById("owner1").textContent = owner;
      document.getElementById("owner2").textContent = owner;

      document.getElementById("ward1").textContent = ward;
      document.getElementById("ward2").textContent = ward;

      document.getElementById("doorNo1").textContent = doorNo;
      document.getElementById("doorNo2").textContent = doorNo;

      document.getElementById("surveyNo1").textContent = surveyNo;
    }

   function generateNoticeNumber() {
  const year = new Date().getFullYear();
  const month = String(new Date().getMonth() + 1).padStart(2, '0');
  const random = Math.floor(10000 + Math.random() * 90000);
  return `TMC/OWN/${year}-${month}/${random}`;
}


     function adjustBlankSpaces() {
      const blankSpaces = document.querySelectorAll('.blank-space');
      blankSpaces.forEach(space => {
        const content = space.textContent.trim();
        if (content) {
          space.style.minWidth = content.length * 10 + 'px';
        }
      });
    }
// Move this outside any function!
window.onload = function () {
  applyArcadeExpressions();
  populateFields();
  adjustBlankSpaces(); 
};

  

  </script>

</body>
</html>
