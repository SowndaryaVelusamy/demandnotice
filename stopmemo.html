<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Thiruvananthapuram Corporation Memo</title>
  <style>
    @media print {
      body {
        margin: 0;
        padding: 0;
      }
      @page {
        size: A4;
        margin: 2cm;
      }
    }
      .blank-space {
   display: inline-block;
      border-bottom: 1px dotted #000;
      min-width: 150px;
      margin: 0 5px;

  }
    
    body {
      font-family: "Times New Roman", serif;
      width: 210mm;
      min-height: 297mm;
      margin: 0 auto;
      padding: 2cm;
      line-height: 1.6;
      box-sizing: border-box;
      background: white;
      font-size: 18px; 
    }
    
    .header {
      text-align: center;
      margin-bottom: 30px;
    }
    
    .logo {
      width: 80px;
      height: auto;
      margin-bottom: 10px;
    }
    
    h3 {
      margin: 10px 0;
      font-size: 18px;
      font-weight: bold;
    }
    
    .meta {
      margin-top: 30px;
      margin-bottom: 20px;
      display: flex;
      justify-content: space-between;
      font-size: 14px;
      font-weight: bold;
    }
     .line {
      display: flex;
      justify-content: space-between;
      border-top: 1px solid #000;
      border-bottom: 1px solid #000;
      padding-bottom: 5px;
      margin-bottom: 20px;
    }

    .memo-title {
      text-align: center;
      margin: 30px 0;
      font-weight: bold;
      text-decoration: underline;
      font-size: 16px;
      letter-spacing: 2px;
    }
    
    .content {
      text-align: justify;
      font-size: 14px;
      line-height: 1.8;
    }
    
    .content p {
      margin-bottom: 15px;
    }
    
    .signature {
      margin-top: 80px;
      text-align: right;
      font-weight: bold;
      font-size: 14px;
    }
    
    .section-title {
      font-weight: bold;
      margin-top: 30px;
      margin-bottom: 20px;
      text-decoration: underline;
      text-align: center;
      font-size: 14px;
    }
    
    .dots {
      color: #333;
      
    }
    
    .tab-indent {
      text-indent: 2em;
    }
    
    .spaced-paragraph {
      margin-top: 25px;
    }
    
    .subject-line {
      margin-bottom: 20px;
    }
  </style>
</head>
<body>
  <div class="header">
    <img src="https://upload.wikimedia.org/wikipedia/commons/thumb/7/70/Seal_of_Corporation_of_Thiruvananthapuram_by_dhevilal.svg/600px-Seal_of_Corporation_of_Thiruvananthapuram_by_dhevilal.svg.png?20180901020657" 
         class="logo"
         alt="Seal of Thiruvananthapuram Corporation">
    <h3>THIRUVANANTHAPURAM CORPORATION</h3>
  </div>
  

    <div class="line">
      <p>Number: <span id="noticeNo"></span></p>
      <p>Date: <span id="noticeDate"></span></p>
    </div>

  <div class="memo-title">MEMO</div>
  
  <div class="content">
   <p style="white-space: nowrap;">
  <strong>Subject: Construction/Reconstruction</strong>
  <span class="dots" style: "text-align:justify;">......................................................................................................................</span>
</p>
<p>
  <span class="dots"  style: "text-align:justify;">...............................................................................................................................................................................</span>
</p>

    <p><strong>License and Approved plan called for reference -</strong></p>
    
    <div class="spaced-paragraph">
      <p class="tab-indent"  style: "text-align:justify;">It has been reported to the undersigned that Sri/Smt. ......<span id="owner2"  class="blank-space "></span>.....................
.....................................................................................................................................................................................
has commenced/completed the construction of a ......................................................................................................
....................................................................................................................................................................................... .</p>
      
      <p class="tab-indent"  style: "text-align:justify;">There for .............................................................. is hereby directed to stop the work immediately and produce the license and approved plan, if any, obtained from this office within three days of receiving this memo for verification. Failing to do so will result in action being initiated as per the relevant rules.</p>
    </div>
    
    <p class="section-title">Details of Unauthorized Construction</p>
    
    <div style="height: 200px;"></div>
  </div>
  
  <div class="signature">
    Assistant Engineer<br>
    Thiruvananthapuram Corporation
  </div>
</body>
  <script>
    function evaluateArcadeExpression(feature, expression) {
      try {
        if (!expression || !feature) return "";
        if (expression.startsWith('$feature.')) {
          const fieldName = expression.replace('$feature.', '').trim();
          return feature[fieldName] || "";
        }
        if (expression.startsWith('IIF(')) {
          const regex = /IIF\(\$feature\.(\w+)\s*==\s*['"](.*?)['"],\s*\$feature\.(\w+),\s*\$feature\.(\w+)\)/;
          const match = expression.match(regex);
          if (match) {
            const [_, fieldName, compareValue, trueField, falseField] = match;
            return feature[fieldName] === compareValue ? feature[trueField] : feature[falseField];
          }
        }
        if (expression.includes('+')) {
          const parts = expression.split('+');
          return parts.map(part => {
            part = part.trim();
            if (part.startsWith('$feature.')) {
              const fieldName = part.replace('$feature.', '').trim();
              return feature[fieldName] || "";
            } else {
              return part.replace(/['"]/g, '');
            }
          }).join('');
        }
        return expression;
      } catch (error) {
        console.error("Error evaluating Arcade expression:", error);
        return "";
      }
    }

    function getFeatureFromParams() {
      const params = new URLSearchParams(window.location.search);
      return {
        WARD_NAME: params.get("ward"),
        DOOR_NO: params.get("id"),
        OWNER_NAME: params.get("owner"),
        SURVEY_NO: params.get("surveyNo"),
      };
    }

  function applyArcadeExpressions() {
      const feature = getFeatureFromParams();
      const noticeNo = generateNoticeNumber();
      const noticeDate = new Date().toLocaleDateString('en-IN');

      const owner = evaluateArcadeExpression(feature, "$feature.OWNER_NAME");
      const ward = evaluateArcadeExpression(feature, "$feature.WARD_NAME");
      const doorNo = "T" + evaluateArcadeExpression(feature, "$feature.DOOR_NO");
      const surveyNo = evaluateArcadeExpression(feature, "$feature.SURVEY_NO");

      document.getElementById("notice_number").textContent = noticeNo;
document.getElementById("notice_date").textContent = noticeDate;

document.getElementById("owner_new").textContent = owner;
document.getElementById("owner2").textContent = owner;

document.getElementById("ward1").textContent = ward;
document.getElementById("ward2").textContent = ward;

document.getElementById("doorNo1").textContent = doorNo;
document.getElementById("doorNo2").textContent = doorNo;

document.getElementById("surveyNo1").textContent = surveyNo;

    }

   function generateNoticeNumber() {
  const year = new Date().getFullYear();
  const month = String(new Date().getMonth() + 1).padStart(2, '0');
  const random = Math.floor(10000 + Math.random() * 90000);
  return `TMC/OWN/${year}-${month}/${random}`;
}


     function adjustBlankSpaces() {
      const blankSpaces = document.querySelectorAll('.blank-space');
      blankSpaces.forEach(space => {
        const content = space.textContent.trim();
        if (content) {
          space.style.minWidth = content.length * 10 + 'px';
        }
      });
    }
// Move this outside any function!
window.onload = function () {
  applyArcadeExpressions();
 
  adjustBlankSpaces(); 
};

  
</script>


</html>
